<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>喵星人日志过滤系统 🐱</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet"/>
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #FFE4E1 0%, #FFF8DC 100%);
            min-height: 100vh;
        }
        
        .cat-paw {
            cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="%23FF69B4"><path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.9 1 3 1.9 3 3V21C3 22.1 3.9 23 5 23H19C20.1 23 21 22.1 21 21V9H21Z"/></svg>'), auto;
        }
        
        .floating-heart {
            position: absolute;
            color: #FFC0CB;
            animation: float 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
        }
        
        .gradient-text {
            background: linear-gradient(45deg, #FF69B4, #FFB6C1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(255, 182, 193, 0.3);
        }
        
        .loading-cat {
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #FFB6C1, #FF69B4);
            border-radius: 10px;
            height: 8px;
            transition: width 0.3s ease;
        }
        
        .chat-bubble {
            animation: slideInUp 0.5s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        #particles-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        .notification {
            transition: transform 0.3s ease;
        }
        
        .copy-btn {
            transition: all 0.2s ease;
        }
        
        .copy-btn:hover {
            transform: scale(1.1);
        }
        
        .log-entry {
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }
        
        .log-entry:hover {
            border-left-color: #ec4899;
            background-color: #fdf2f8;
        }
    </style>
</head>
<body class="cat-paw">
    <canvas id="particles-canvas"></canvas>
    
    <!-- 导航栏 -->
    <nav class="fixed top-0 w-full z-50 glass-effect">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-pink-500 rounded-full flex items-center justify-center text-white">🐱</div>
                    <h1 class="text-xl font-bold gradient-text">喵星人日志过滤系统</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="help-btn" class="px-4 py-2 bg-pink-100 text-pink-600 rounded-full hover:bg-pink-200 transition-colors">
                        🆘 帮助
                    </button>
                    <button id="tutorial-btn" class="px-4 py-2 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition-colors">
                        📚 教程
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- 开场动画 -->
    <div id="loading-screen" class="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-pink-100 to-pink-200">
        <div class="text-center">
            <div class="loading-cat mb-6">
                <div class="w-32 h-32 mx-auto bg-pink-500 rounded-full flex items-center justify-center text-white text-6xl">🐱</div>
            </div>
            <h2 class="text-2xl font-bold text-pink-600 mb-4">喵星人正在准备中...</h2>
            <div class="w-64 h-2 bg-pink-100 rounded-full overflow-hidden mx-auto">
                <div id="loading-progress" class="progress-bar w-0"></div>
            </div>
            <p id="loading-text" class="text-pink-500 mt-2">初始化猫咪系统...</p>
        </div>
    </div>

    <!-- 主界面 -->
    <div id="main-content" class="pt-20 min-h-screen hidden">
        <!-- 欢迎横幅 -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-8">
            <div class="glass-effect rounded-2xl p-6 text-center hover-lift">
                <h2 class="text-3xl font-bold gradient-text mb-2">欢迎来到喵星人日志过滤系统！🐱</h2>
                <p class="text-gray-600">让可爱的猫咪帮您过滤日志，集合运算变得简单有趣！</p>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- 左侧控制面板 -->
                <div class="lg:col-span-1 space-y-6">
                    <!-- 文件上传 -->
                    <div class="glass-effect rounded-2xl p-6 hover-lift">
                        <h3 class="text-xl font-semibold text-pink-600 mb-4 flex items-center">
                            📁 上传日志文件
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">应用日志</label>
                                <div class="border-2 border-dashed border-pink-300 rounded-lg p-4 text-center hover:border-pink-400 transition-colors">
                                    <input type="file" id="app-log-file" class="hidden" accept=".log,.txt"/>
                                    <div class="cursor-pointer" onclick="document.getElementById('app-log-file').click()">
                                        <div class="text-4xl mb-2">📝</div>
                                        <p class="text-pink-600">点击或拖拽上传应用日志</p>
                                    </div>
                                </div>
                                <div id="app-log-preview" class="mt-2 text-sm text-gray-600 hidden"></div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">数据库日志</label>
                                <div class="border-2 border-dashed border-pink-300 rounded-lg p-4 text-center hover:border-pink-400 transition-colors">
                                    <input type="file" id="db-log-file" class="hidden" accept=".log,.txt"/>
                                    <div class="cursor-pointer" onclick="document.getElementById('db-log-file').click()">
                                        <div class="text-4xl mb-2">🗄️</div>
                                        <p class="text-pink-600">点击或拖拽上传数据库日志</p>
                                    </div>
                                </div>
                                <div id="db-log-preview" class="mt-2 text-sm text-gray-600 hidden"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 关键词配置 -->
                    <div class="glass-effect rounded-2xl p-6 hover-lift">
                        <h3 class="text-xl font-semibold text-pink-600 mb-4 flex items-center">
                            🔍 关键词设置
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    排除关键词 
                                    <span class="text-xs text-gray-500">(用逗号分隔)</span>
                                </label>
                                <input type="text" id="exclude-keywords" placeholder="DEBUG,INFO,TRACE" class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300"/>
                                <div class="mt-2 flex flex-wrap gap-1" id="exclude-tags"></div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    保留关键词 
                                    <span class="text-xs text-gray-500">(用逗号分隔)</span>
                                </label>
                                <input type="text" id="include-keywords" placeholder="ERROR,WARN,FATAL" class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300"/>
                                <div class="mt-2 flex flex-wrap gap-1" id="include-tags"></div>
                            </div>
                            <div class="pt-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="enable-correlation" class="mr-2 text-pink-500"/>
                                    <span class="text-sm text-gray-700">启用关联筛选</span>
                                </label>
                                <div id="correlation-options" class="mt-3 hidden">
                                    <div class="text-sm text-gray-600 mb-2">关联条件：</div>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="checkbox" id="app-error" class="mr-2 text-pink-500" checked/>
                                            <span class="text-sm">应用日志含 ERROR</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="db-connection" class="mr-2 text-pink-500" checked/>
                                            <span class="text-sm">数据库日志含 Connection</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 快速操作 -->
                    <div class="glass-effect rounded-2xl p-6 hover-lift">
                        <h3 class="text-xl font-semibold text-pink-600 mb-4 flex items-center">
                            ⚡ 快速操作
                        </h3>
                        <div class="space-y-3">
                            <button id="filter-btn" class="w-full bg-pink-500 text-white py-3 rounded-lg hover:bg-pink-600 transition-colors font-medium">
                                🚀 开始过滤
                            </button>
                            <button id="clear-btn" class="w-full bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 transition-colors">
                                🗑️ 清空数据
                            </button>
                            <button id="sample-btn" class="w-full bg-purple-200 text-purple-700 py-3 rounded-lg hover:bg-purple-300 transition-colors">
                                🎲 加载示例
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 右侧结果展示 -->
                <div class="lg:col-span-2">
                    <!-- 统计信息 -->
                    <div class="glass-effect rounded-2xl p-6 mb-6 hover-lift">
                        <h3 class="text-xl font-semibold text-pink-600 mb-4 flex items-center">
                            📊 处理统计
                        </h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-pink-600" id="total-logs">0</div>
                                <div class="text-sm text-gray-600">原始日志</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-pink-600" id="excluded-logs">0</div>
                                <div class="text-sm text-gray-600">已排除</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-pink-600" id="filtered-logs">0</div>
                                <div class="text-sm text-gray-600">过滤结果</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-pink-600" id="correlation-pairs">0</div>
                                <div class="text-sm text-gray-600">关联对数</div>
                            </div>
                        </div>
                    </div>

                    <!-- 结果标签页 -->
                    <div class="glass-effect rounded-2xl p-6 hover-lift">
                        <div class="flex space-x-4 mb-6">
                            <button id="tab-single" class="px-4 py-2 bg-pink-500 text-white rounded-lg font-medium">
                                单日志结果
                            </button>
                            <button id="tab-correlation" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300">
                                关联结果
                            </button>
                        </div>

                        <!-- 单日志结果 -->
                        <div id="single-results" class="space-y-4">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="text-lg font-semibold text-gray-800">过滤后的日志</h4>
                                <div class="flex space-x-2">
                                    <button id="expand-all" class="px-3 py-1 bg-pink-100 text-pink-600 rounded text-sm hover:bg-pink-200">
                                        展开全部
                                    </button>
                                    <button id="collapse-all" class="px-3 py-1 bg-pink-100 text-pink-600 rounded text-sm hover:bg-pink-200">
                                        折叠全部
                                    </button>
                                </div>
                            </div>
                            <div id="single-logs-container" class="space-y-2 max-h-96 overflow-y-auto">
                                <div class="text-center text-gray-500 py-8">
                                    <div class="text-4xl mb-2">🐱</div>
                                    <p>还没有过滤结果，快上传日志文件开始吧！</p>
                                </div>
                            </div>
                        </div>

                        <!-- 关联结果 -->
                        <div id="correlation-results" class="hidden space-y-4">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="text-lg font-semibold text-gray-800">关联日志对</h4>
                                <div class="text-sm text-gray-600">
                                    显示 <span id="correlation-count">0</span> 对关联日志
                                </div>
                            </div>
                            <div id="correlation-logs-container" class="space-y-3 max-h-96 overflow-y-auto">
                                <div class="text-center text-gray-500 py-8">
                                    <div class="text-4xl mb-2">🔗</div>
                                    <p>启用关联筛选后才会显示相关结果哦！</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 智能机器人助手 -->
    <div id="assistant" class="fixed bottom-6 right-6 z-40">
        <div id="assistant-button" class="w-16 h-16 bg-pink-500 rounded-full shadow-lg cursor-pointer hover:bg-pink-600 transition-colors flex items-center justify-center text-white text-2xl hover-lift">
            🤖
        </div>
        <div id="chat-window" class="hidden fixed bottom-20 right-0 w-80 h-96 bg-white rounded-2xl shadow-2xl overflow-hidden">
            <div class="bg-pink-500 text-white p-4 flex justify-between items-center">
                <h3 class="font-semibold">喵星人智能助手</h3>
                <button id="close-chat" class="text-white hover:text-pink-200">✕</button>
            </div>
            <div id="chat-messages" class="h-64 overflow-y-auto p-4 space-y-2">
                <div class="chat-bubble bg-pink-50 p-3 rounded-lg">
                    <p class="text-sm">你好！我是喵星人智能助手，有什么关于日志过滤的问题可以问我哦～</p>
                </div>
            </div>
            <div class="p-4 border-t">
                <div class="flex space-x-2">
                    <input type="text" id="chat-input" placeholder="输入问题..." class="flex-1 px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-300"/>
                    <button id="send-message" class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600">发送</button>
                </div>
                <div class="mt-2 flex flex-wrap gap-1">
                    <button class="quick-question px-2 py-1 bg-pink-100 text-pink-600 rounded text-xs hover:bg-pink-200">怎么上传日志</button>
                    <button class="quick-question px-2 py-1 bg-pink-100 text-pink-600 rounded text-xs hover:bg-pink-200">关键词设置</button>
                    <button class="quick-question px-2 py-1 bg-pink-100 text-pink-600 rounded text-xs hover:bg-pink-200">关联筛选</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 帮助弹窗 -->
    <div id="help-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-pink-600">使用帮助</h2>
                <button id="close-help" class="text-gray-500 hover:text-gray-700">✕</button>
            </div>
            <div class="space-y-4 text-gray-700">
                <div>
                    <h3 class="font-semibold text-pink-600 mb-2">📁 上传日志文件</h3>
                    <p>支持上传应用日志和数据库日志文件，支持 .log 和 .txt 格式。</p>
                </div>
                <div>
                    <h3 class="font-semibold text-pink-600 mb-2">🔍 关键词设置</h3>
                    <p><strong>排除关键词：</strong>包含这些词的日志将被过滤掉</p>
                    <p><strong>保留关键词：</strong>在排除后的结果中，只保留包含这些词的日志</p>
                </div>
                <div>
                    <h3 class="font-semibold text-pink-600 mb-2">🔗 关联筛选</h3>
                    <p>启用后可以筛选出应用日志和数据库日志之间的关联关系。</p>
                </div>
                <div>
                    <h3 class="font-semibold text-pink-600 mb-2">📊 集合运算原理</h3>
                    <p><strong>差集运算：</strong>原始日志集 - 排除关键词日志集</p>
                    <p><strong>交集运算：</strong>结果集 ∩ 保留关键词日志集</p>
                    <p><strong>笛卡尔积：</strong>多日志源的关联筛选</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="bg-white bg-opacity-50 mt-12 py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-600">© 2024 喵星人日志过滤系统 - 让集合运算变得可爱又有趣！</p>
        </div>
    </footer>

    <script>
        // 完整的JavaScript代码
        class CatLogFilter {
            constructor() {
                this.appLogs = [];
                this.dbLogs = [];
                this.filteredLogs = [];
                this.correlationPairs = [];
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.initParticles();
                this.showLoadingScreen();
                this.initAssistant();
            }

            setupEventListeners() {
                // 文件上传
                document.getElementById('app-log-file').addEventListener('change', (e) => this.handleFileUpload(e, 'app'));
                document.getElementById('db-log-file').addEventListener('change', (e) => this.handleFileUpload(e, 'db'));

                // 关键词输入
                document.getElementById('exclude-keywords').addEventListener('input', (e) => this.updateTags(e, 'exclude'));
                document.getElementById('include-keywords').addEventListener('input', (e) => this.updateTags(e, 'include'));

                // 关联筛选
                document.getElementById('enable-correlation').addEventListener('change', (e) => {
                    document.getElementById('correlation-options').classList.toggle('hidden', !e.target.checked);
                });

                // 按钮事件
                document.getElementById('filter-btn').addEventListener('click', () => this.filterLogs());
                document.getElementById('clear-btn').addEventListener('click', () => this.clearData());
                document.getElementById('sample-btn').addEventListener('click', () => this.loadSampleData());

                // 标签页切换
                document.getElementById('tab-single').addEventListener('click', () => this.switchTab('single'));
                document.getElementById('tab-correlation').addEventListener('click', () => this.switchTab('correlation'));

                // 展开/折叠
                document.getElementById('expand-all').addEventListener('click', () => this.toggleAllLogs(true));
                document.getElementById('collapse-all').addEventListener('click', () => this.toggleAllLogs(false));

                // 帮助和教程
                document.getElementById('help-btn').addEventListener('click', () => this.showHelp());
                document.getElementById('tutorial-btn').addEventListener('click', () => this.showTutorial());
                document.getElementById('close-help').addEventListener('click', () => this.hideHelp());

                // 拖拽上传
                this.setupDragAndDrop();
            }

            setupDragAndDrop() {
                const dropZones = document.querySelectorAll('.border-dashed');
                dropZones.forEach(zone => {
                    zone.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        zone.classList.add('border-pink-400', 'bg-pink-50');
                    });

                    zone.addEventListener('dragleave', () => {
                        zone.classList.remove('border-pink-400', 'bg-pink-50');
                    });

                    zone.addEventListener('drop', (e) => {
                        e.preventDefault();
                        zone.classList.remove('border-pink-400', 'bg-pink-50');
                        
                        const files = e.dataTransfer.files;
                        if (files.length > 0) {
                            const file = files[0];
                            const type = zone.querySelector('input').id.includes('app') ? 'app' : 'db';
                            this.processFile(file, type);
                        }
                    });
                });
            }

            async handleFileUpload(event, type) {
                const file = event.target.files[0];
                if (file) {
                    await this.processFile(file, type);
                }
            }

            async processFile(file, type) {
                const previewId = type === 'app' ? 'app-log-preview' : 'db-log-preview';
                const previewElement = document.getElementById(previewId);
                
                try {
                    const text = await this.readFileAsText(file);
                    const logs = text.split('\n').filter(line => line.trim());
                    
                    if (type === 'app') {
                        this.appLogs = logs;
                    } else {
                        this.dbLogs = logs;
                    }

                    previewElement.textContent = `已加载 ${logs.length} 行日志`;
                    previewElement.classList.remove('hidden');
                    
                    this.updateStatistics();
                    
                    // 显示成功提示
                    this.showNotification(`成功加载 ${file.name}`, 'success');
                } catch (error) {
                    previewElement.textContent = '文件读取失败';
                    previewElement.classList.remove('hidden');
                    this.showNotification('文件读取失败', 'error');
                }
            }

            readFileAsText(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = e => resolve(e.target.result);
                    reader.onerror = e => reject(e);
                    reader.readAsText(file);
                });
            }

            updateTags(event, type) {
                const containerId = type === 'exclude' ? 'exclude-tags' : 'include-tags';
                const container = document.getElementById(containerId);
                const keywords = event.target.value.split(',').map(k => k.trim()).filter(k => k);
                
                container.innerHTML = '';
                keywords.forEach(keyword => {
                    if (keyword) {
                        const tag = document.createElement('span');
                        tag.className = 'px-2 py-1 bg-pink-100 text-pink-700 rounded-full text-xs';
                        tag.textContent = keyword;
                        container.appendChild(tag);
                    }
                });
            }

            filterLogs() {
                if (this.appLogs.length === 0 && this.dbLogs.length === 0) {
                    this.showNotification('请先上传日志文件', 'warning');
                    return;
                }

                const excludeKeywords = document.getElementById('exclude-keywords').value
                    .split(',')
                    .map(k => k.trim())
                    .filter(k => k);
                
                const includeKeywords = document.getElementById('include-keywords').value
                    .split(',')
                    .map(k => k.trim())
                    .filter(k => k);

                // 过滤应用日志
                let filteredAppLogs = this.appLogs.filter(log => {
                    // 排除包含排除关键词的日志
                    if (excludeKeywords.some(keyword => log.includes(keyword))) {
                        return false;
                    }
                    // 如果设置了保留关键词，只保留包含这些关键词的日志
                    if (includeKeywords.length > 0) {
                        return includeKeywords.some(keyword => log.includes(keyword));
                    }
                    return true;
                });

                // 过滤数据库日志
                let filteredDbLogs = this.dbLogs.filter(log => {
                    if (excludeKeywords.some(keyword => log.includes(keyword))) {
                        return false;
                    }
                    if (includeKeywords.length > 0) {
                        return includeKeywords.some(keyword => log.includes(keyword));
                    }
                    return true;
                });

                this.filteredLogs = [...filteredAppLogs, ...filteredDbLogs];

                // 关联分析
                if (document.getElementById('enable-correlation').checked) {
                    this.analyzeCorrelation(filteredAppLogs, filteredDbLogs);
                } else {
                    this.correlationPairs = [];
                }

                this.displayResults();
                this.updateStatistics();
                this.showNotification('日志过滤完成！', 'success');
            }

            analyzeCorrelation(appLogs, dbLogs) {
                this.correlationPairs = [];
                
                // 简单的关联分析：基于时间戳或错误ID
                appLogs.forEach(appLog => {
                    dbLogs.forEach(dbLog => {
                        // 提取可能的时间戳（简化版）
                        const appTime = this.extractTimestamp(appLog);
                        const dbTime = this.extractTimestamp(dbLog);
                        
                        // 如果时间戳相近（在10秒内），认为是关联的
                        if (appTime && dbTime && Math.abs(appTime - dbTime) < 10000) {
                            this.correlationPairs.push({
                                appLog,
                                dbLog,
                                timestamp: appTime
                            });
                        }
                    });
                });
            }

            extractTimestamp(log) {
                // 简单的日期时间提取（实际项目中需要更复杂的解析）
                const timestampRegex = /\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/;
                const match = log.match(timestampRegex);
                if (match) {
                    return new Date(match[0]).getTime();
                }
                return null;
            }

            displayResults() {
                this.displaySingleLogs();
                this.displayCorrelationLogs();
            }

            displaySingleLogs() {
                const container = document.getElementById('single-logs-container');
                
                if (this.filteredLogs.length === 0) {
                    container.innerHTML = `
                        <div class="text-center text-gray-500 py-8">
                            <div class="text-4xl mb-2">🐱</div>
                            <p>没有找到匹配的日志记录</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = '';
                this.filteredLogs.forEach((log, index) => {
                    const logElement = document.createElement('div');
                    logElement.className = 'log-entry bg-white rounded-lg p-3 border border-pink-100 hover:border-pink-300 transition-colors';
                    logElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="text-sm text-gray-600 mb-1">日志 #${index + 1}</div>
                                <div class="text-gray-800 font-mono text-sm break-all">${this.escapeHtml(log)}</div>
                            </div>
                            <button class="ml-2 text-pink-500 hover:text-pink-700 copy-btn" data-log="${this.escapeHtml(log)}">
                                📋
                            </button>
                        </div>
                    `;
                    container.appendChild(logElement);
                });

                // 添加复制功能
                document.querySelectorAll('.copy-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const log = e.target.getAttribute('data-log');
                        navigator.clipboard.writeText(log).then(() => {
                            this.showNotification('日志已复制到剪贴板', 'success');
                        });
                    });
                });
            }

            displayCorrelationLogs() {
                const container = document.getElementById('correlation-logs-container');
                const countElement = document.getElementById('correlation-count');
                
                countElement.textContent = this.correlationPairs.length;

                if (this.correlationPairs.length === 0) {
                    container.innerHTML = `
                        <div class="text-center text-gray-500 py-8">
                            <div class="text-4xl mb-2">🔗</div>
                            <p>没有找到关联的日志对</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = '';
                this.correlationPairs.forEach((pair, index) => {
                    const pairElement = document.createElement('div');
                    pairElement.className = 'bg-white rounded-lg p-4 border-2 border-purple-100 hover:border-purple-300 transition-colors';
                    pairElement.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold text-purple-600">关联对 #${index + 1}</span>
                            <span class="text-xs text-gray-500">${new Date(pair.timestamp).toLocaleString()}</span>
                        </div>
                        <div class="space-y-2">
                            <div class="flex items-start">
                                <span class="inline-block w-16 text-sm text-gray-500">应用:</span>
                                <div class="flex-1 bg-pink-50 p-2 rounded text-sm break-all">${this.escapeHtml(pair.appLog)}</div>
                            </div>
                            <div class="flex items-start">
                                <span class="inline-block w-16 text-sm text-gray-500">数据库:</span>
                                <div class="flex-1 bg-blue-50 p-2 rounded text-sm break-all">${this.escapeHtml(pair.dbLog)}</div>
                            </div>
                        </div>
                    `;
                    container.appendChild(pairElement);
                });
            }

            updateStatistics() {
                const totalLogs = this.appLogs.length + this.dbLogs.length;
                const excludedLogs = totalLogs - this.filteredLogs.length;
                
                document.getElementById('total-logs').textContent = totalLogs;
                document.getElementById('excluded-logs').textContent = excludedLogs;
                document.getElementById('filtered-logs').textContent = this.filteredLogs.length;
                document.getElementById('correlation-pairs').textContent = this.correlationPairs.length;
            }

            clearData() {
                this.appLogs = [];
                this.dbLogs = [];
                this.filteredLogs = [];
                this.correlationPairs = [];
                
                document.getElementById('app-log-file').value = '';
                document.getElementById('db-log-file').value = '';
                document.getElementById('app-log-preview').classList.add('hidden');
                document.getElementById('db-log-preview').classList.add('hidden');
                document.getElementById('exclude-keywords').value = '';
                document.getElementById('include-keywords').value = '';
                document.getElementById('exclude-tags').innerHTML = '';
                document.getElementById('include-tags').innerHTML = '';
                
                this.updateStatistics();
                this.displayResults();
                this.showNotification('数据已清空', 'info');
            }

            loadSampleData() {
                // 示例应用日志
                this.appLogs = [
                    '2024-01-15 10:00:01 INFO Application started successfully',
                    '2024-01-15 10:00:02 DEBUG Loading configuration files',
                    '2024-01-15 10:00:03 ERROR Database connection failed: Connection timeout',
                    '2024-01-15 10:00:04 WARN Retrying database connection...',
                    '2024-01-15 10:00:05 INFO Database connection established',
                    '2024-01-15 10:00:06 DEBUG User login: john_doe',
                    '2024-01-15 10:00:07 ERROR File not found: /data/config.json',
                    '2024-01-15 10:00:08 INFO Configuration loaded successfully',
                    '2024-01-15 10:00:09 TRACE Memory usage: 45%',
                    '2024-01-15 10:00:10 FATAL Critical system error: Out of memory'
                ];

                // 示例数据库日志
                this.dbLogs = [
                    '2024-01-15 10:00:01 INFO Database server started',
                    '2024-01-15 10:00:02 DEBUG Connection pool initialized',
                    '2024-01-15 10:00:03 ERROR Connection timeout from 192.168.1.100',
                    '2024-01-15 10:00:04 WARN Too many connection attempts',
                    '2024-01-15 10:00:05 INFO New connection established',
                    '2024-01-15 10:00:06 DEBUG Query executed: SELECT * FROM users',
                    '2024-01-15 10:00:07 ERROR Table not found: config_data',
                    '2024-01-15 10:00:08 INFO Query completed successfully',
                    '2024-01-15 10:00:09 TRACE Query execution time: 120ms',
                    '2024-01-15 10:00:10 FATAL Database crash detected'
                ];

                document.getElementById('app-log-preview').textContent = '已加载 10 行示例应用日志';
                document.getElementById('app-log-preview').classList.remove('hidden');
                document.getElementById('db-log-preview').textContent = '已加载 10 行示例数据库日志';
                document.getElementById('db-log-preview').classList.remove('hidden');

                this.updateStatistics();
                this.showNotification('示例数据加载完成！', 'success');
            }

            switchTab(tab) {
                const singleTab = document.getElementById('tab-single');
                const correlationTab = document.getElementById('tab-correlation');
                const singleResults = document.getElementById('single-results');
                const correlationResults = document.getElementById('correlation-results');

                if (tab === 'single') {
                    singleTab.className = 'px-4 py-2 bg-pink-500 text-white rounded-lg font-medium';
                    correlationTab.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300';
                    singleResults.classList.remove('hidden');
                    correlationResults.classList.add('hidden');
                } else {
                    singleTab.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300';
                    correlationTab.className = 'px-4 py-2 bg-pink-500 text-white rounded-lg font-medium';
                    singleResults.classList.add('hidden');
                    correlationResults.classList.remove('hidden');
                }
            }

            toggleAllLogs(expand) {
                this.showNotification(expand ? '已展开所有日志' : '已折叠所有日志', 'info');
            }

            showHelp() {
                document.getElementById('help-modal').classList.remove('hidden');
            }

            hideHelp() {
                document.getElementById('help-modal').classList.add('hidden');
            }

            showTutorial() {
                const tutorialContent = `
                    <div class="space-y-6">
                        <div>
                            <h3 class="font-semibold text-pink-600 mb-2">🎯 第一步：上传日志文件</h3>
                            <p class="text-gray-700">点击上传区域或直接拖拽日志文件到指定区域。支持 .log 和 .txt 格式。</p>
                        </div>
                        <div>
                            <h3 class="font-semibold text-pink-600 mb-2">🔧 第二步：设置过滤条件</h3>
                            <p class="text-gray-700">在关键词设置区域输入要排除和保留的关键词，用逗号分隔。</p>
                            <ul class="list-disc list-inside text-gray-600 mt-2">
                                <li><strong>排除关键词：</strong>包含这些词的日志会被过滤掉</li>
                                <li><strong>保留关键词：</strong>在排除后，只保留包含这些词的日志</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="font-semibold text-pink-600 mb-2">🚀 第三步：开始过滤</h3>
                            <p class="text-gray-700">点击"开始过滤"按钮，系统会执行集合运算并显示结果。</p>
                        </div>
                        <div>
                            <h3 class="font-semibold text-pink-600 mb-2">📊 第四步：查看结果</h3>
                            <p class="text-gray-700">在结果区域查看过滤后的日志和关联分析结果。</p>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800 mb-2">💡 集合运算原理</h4>
                            <p class="text-yellow-700 text-sm">
                                系统执行的是两次集合运算：<br>
                                1. <strong>差集</strong>：原始日志 - 包含排除关键词的日志<br>
                                2. <strong>交集</strong>：差集结果 ∩ 包含保留关键词的日志
                            </p>
                        </div>
                    </div>
                `;

                this.showModal('使用教程', tutorialContent);
            }

            showModal(title, content) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50';
                modal.innerHTML = `
                    <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-pink-600">${title}</h2>
                            <button class="text-gray-500 hover:text-gray-700 close-modal">✕</button>
                        </div>
                        ${content}
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                modal.querySelector('.close-modal').addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        document.body.removeChild(modal);
                    }
                });
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                const bgColor = type === 'success' ? 'bg-green-500' : 
                                type === 'error' ? 'bg-red-500' : 
                                type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500';
                
                notification.className = `fixed top-20 right-6 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform z-50`;
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);
                
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 3000);
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            initParticles() {
                const canvas = document.getElementById('particles-canvas');
                const ctx = canvas.getContext('2d');
                
                function resizeCanvas() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
                
                resizeCanvas();
                window.addEventListener('resize', resizeCanvas);
                
                const particles = [];
                for (let i = 0; i < 30; i++) {
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        size: Math.random() * 3 + 1,
                        speedX: Math.random() * 0.5 - 0.25,
                        speedY: Math.random() * 0.5 - 0.25
                    });
                }
                
                function animate() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    particles.forEach(particle => {
                        particle.x += particle.speedX;
                        particle.y += particle.speedY;
                        
                        if (particle.x < 0 || particle.x > canvas.width) particle.speedX *= -1;
                        if (particle.y < 0 || particle.y > canvas.height) particle.speedY *= -1;
                        
                        ctx.fillStyle = 'rgba(255, 182, 193, 0.3)';
                        ctx.beginPath();
                        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        ctx.fill();
                    });
                    
                    requestAnimationFrame(animate);
                }
                
                animate();
            }

            showLoadingScreen() {
                const loadingScreen = document.getElementById('loading-screen');
                const progressBar = document.getElementById('loading-progress');
                const loadingText = document.getElementById('loading-text');
                const mainContent = document.getElementById('main-content');
                
                const steps = [
                    '初始化猫咪系统...',
                    '加载日志解析器...',
                    '准备过滤引擎...',
                    '启动关联分析...',
                    '准备完成！'
                ];
                
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 20;
                    progressBar.style.width = `${progress}%`;
                    
                    if (progress <= 100) {
                        loadingText.textContent = steps[progress / 20 - 1];
                    }
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => {
                            loadingScreen.style.opacity = '0';
                            setTimeout(() => {
                                loadingScreen.classList.add('hidden');
                                mainContent.classList.remove('hidden');
                                this.createFloatingHearts();
                            }, 500);
                        }, 500);
                    }
                }, 300);
            }

            createFloatingHearts() {
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        const heart = document.createElement('div');
                        heart.className = 'floating-heart';
                        heart.textContent = '💖';
                        heart.style.left = `${Math.random() * 100}%`;
                        heart.style.animationDelay = `${Math.random() * 2}s`;
                        document.body.appendChild(heart);
                        
                        setTimeout(() => {
                            document.body.removeChild(heart);
                        }, 3000);
                    }, i * 500);
                }
            }

            initAssistant() {
                const assistantButton = document.getElementById('assistant-button');
                const chatWindow = document.getElementById('chat-window');
                const closeChat = document.getElementById('close-chat');
                const sendButton = document.getElementById('send-message');
                const chatInput = document.getElementById('chat-input');
                const chatMessages = document.getElementById('chat-messages');

                assistantButton.addEventListener('click', () => {
                    chatWindow.classList.toggle('hidden');
                });

                closeChat.addEventListener('click', () => {
                    chatWindow.classList.add('hidden');
                });

                sendButton.addEventListener('click', () => this.sendMessage());
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });

                // 快速问题按钮
                document.querySelectorAll('.quick-question').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        chatInput.value = e.target.textContent;
                        this.sendMessage();
                    });
                });

                // 豆包API配置
                this.doubaoConfig = {
                    url: 'https://ark.cn-beijing.volces.com/api/v3/chat/completions',
                    apiKey: 'a71b9b31-14f1-4dce-abf3-4461cd3176cc', // 您的API密钥
                    model: 'doubao-seed-1-6-251015',
                    enabled: true // 设置为false可禁用API使用备用回复
                };

                // 智能助手知识库（作为备用回复）
                this.assistantKnowledge = {
                    '你好': '你好！我是喵星人智能助手🐱，专门帮您处理日志过滤问题！',
                    '怎么上传日志': '您可以通过点击上传区域或直接拖拽文件来上传日志文件。支持 .log 和 .txt 格式。上传后系统会自动解析日志内容。',
                    '关键词设置': '在关键词设置区域，用逗号分隔输入关键词：\n• 排除关键词：过滤掉包含这些词的日志\n• 保留关键词：在过滤后只保留包含这些词的日志',
                    '关联筛选': '关联筛选可以分析应用日志和数据库日志之间的时间关联，找出相关的错误对。启用后系统会自动匹配时间相近的日志记录。',
                    '集合运算原理': '系统执行两次集合运算：\n1. 差集：原始日志 - 排除关键词日志\n2. 交集：结果集 ∩ 保留关键词日志\n🐱 这样就能精准过滤出您需要的日志啦！',
                    '支持什么文件格式': '目前支持 .log 和 .txt 格式的文本文件。文件大小建议不超过10MB以获得最佳性能。',
                    '怎么清空数据': '点击"清空数据"按钮可以清除所有已上传的日志和过滤设置，让您重新开始。',
                    '加载示例数据': '点击"加载示例"按钮可以体验系统功能，我们会提供模拟的应用日志和数据库日志供您测试。',
                    '谢谢': '不客气！有什么其他日志过滤问题随时问我哦～🐾',
                    '再见': '再见！祝您日志分析顺利，有问题随时召唤我！🐱'
                };

                // 豆包API调用函数
                this.callDoubaoModel = async (message) => {
                    try {
                        const requestBody = {
                            "model": this.doubaoConfig.model,
                            "max_completion_tokens": 4000,
                            "messages": [
                                {
                                    "role": "system",
                                    "content": [
                                        {
                                            "text": `你是一个专业的日志过滤系统助手，名叫"喵星人助手"。你专门帮助用户解决日志分析、过滤和相关技术问题。

系统功能：
1. 日志文件上传和处理（支持.log和.txt格式）
2. 关键词过滤（包含关键词和排除关键词）
3. 多日志源关联分析（应用日志和数据库日志）
4. 集合运算（差集、交集运算）

请用友好、可爱的语气回答，适当使用猫咪表情符号。如果问题与日志分析无关，请礼貌地引导用户关注日志过滤相关话题。

请用中文回答，保持回答简洁明了，专业但不过于技术化。`,
                                            "type": "text"
                                        }
                                    ]
                                },
                                {
                                    "role": "user",
                                    "content": [
                                        {
                                            "text": message,
                                            "type": "text"
                                        }
                                    ]
                                }
                            ],
                            "temperature": 0.7,
                            "top_p": 0.9
                        };

                        const response = await fetch(this.doubaoConfig.url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${this.doubaoConfig.apiKey}`
                            },
                            body: JSON.stringify(requestBody)
                        });

                        if (!response.ok) {
                            const errorText = await response.text();
                            throw new Error(`豆包API请求失败: ${response.status} - ${errorText}`);
                        }

                        const data = await response.json();
                        console.log('豆包API响应:', data);
                        
                        // 解析响应
                        if (data.choices && data.choices[0] && data.choices[0].message) {
                            const messageContent = data.choices[0].message.content;
                            if (Array.isArray(messageContent)) {
                                return messageContent
                                    .filter(item => item.type === 'text')
                                    .map(item => item.text)
                                    .join('\n');
                            } else {
                                return messageContent;
                            }
                        } else {
                            throw new Error('无法解析豆包API响应');
                        }

                    } catch (error) {
                        console.error('调用豆包API失败:', error);
                        return null;
                    }
                };

                // 智能回复函数
                this.getAssistantResponse = async (message) => {
                    try {
                        // 首先尝试使用豆包API
                        if (this.doubaoConfig.enabled) {
                            const apiResponse = await this.callDoubaoModel(message);
                            if (apiResponse) {
                                return apiResponse;
                            }
                        }
                    } catch (error) {
                        console.error('API调用失败:', error);
                    }

                    // 备用回复逻辑
                    return this.getFallbackResponse(message);
                };

                // 备用回复函数
                this.getFallbackResponse = (message) => {
                    const lowerMessage = message.toLowerCase();
                    
                    // 原有的智能匹配逻辑
                    for (const [question, answer] of Object.entries(this.assistantKnowledge)) {
                        if (lowerMessage.includes(question.toLowerCase())) {
                            return answer;
                        }
                    }
                    
                    const keywords = {
                        '上传': '怎么上传日志',
                        '文件': '怎么上传日志',
                        '关键词': '关键词设置',
                        '过滤': '关键词设置',
                        '关联': '关联筛选',
                        '原理': '集合运算原理',
                        '查看': '怎么查看结果',
                        '结果': '怎么查看结果',
                        '格式': '支持什么文件格式',
                        '清空': '怎么清空数据',
                        '示例': '加载示例数据',
                        '帮助': '你好',
                        '谢谢': '谢谢',
                        '再见': '再见'
                    };
                    
                    for (const [keyword, question] of Object.entries(keywords)) {
                        if (lowerMessage.includes(keyword)) {
                            return this.assistantKnowledge[question];
                        }
                    }

                    const defaultResponses = [
                        '喵～我不太明白这个问题。您可以问我关于日志上传、关键词设置、关联筛选等方面的问题。',
                        '作为喵星人助手，我主要擅长日志过滤相关的问题。您可以试试问："怎么上传日志"或"什么是关联筛选"。',
                        '这个问题有点难倒我了🐱。您可以查看帮助文档或尝试重新表述问题。',
                        '喵喵～关于日志过滤的问题我都可以帮忙解答！比如文件上传、关键词设置、结果查看等。'
                    ];
                    
                    return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
                };
            }

            async sendMessage() {
                const chatInput = document.getElementById('chat-input');
                const chatMessages = document.getElementById('chat-messages');
                const message = chatInput.value.trim();

                if (!message) return;

                // 添加用户消息
                this.addMessage(message, 'user');
                chatInput.value = '';

                // 禁用输入框和按钮
                chatInput.disabled = true;
                document.getElementById('send-message').disabled = true;

                // 显示"正在思考"的提示
                const thinkingElement = this.addThinkingMessage();

                try {
                    const response = await this.getAssistantResponse(message);
                    
                    // 移除"正在思考"提示
                    thinkingElement.remove();
                    
                    // 添加最终回复
                    this.addMessage(response, 'assistant');
                    
                } catch (error) {
                    // 移除"正在思考"提示
                    thinkingElement.remove();
                    
                    // 显示错误信息并使用备用回复
                    const fallbackResponse = this.getFallbackResponse(message);
                    this.addMessage(fallbackResponse, 'assistant');
                    
                    console.error('发送消息失败:', error);
                } finally {
                    // 重新启用输入框和按钮
                    chatInput.disabled = false;
                    document.getElementById('send-message').disabled = false;
                    chatInput.focus();
                }
            }

            addThinkingMessage() {
                const chatMessages = document.getElementById('chat-messages');
                const thinkingDiv = document.createElement('div');
                thinkingDiv.className = 'chat-bubble bg-pink-50 p-3 rounded-lg mr-8';
                thinkingDiv.id = 'thinking-message';
                thinkingDiv.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 bg-pink-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-pink-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        <div class="w-2 h-2 bg-pink-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                        <span class="text-sm text-pink-600">喵星人思考中...</span>
                    </div>
                `;
                
                chatMessages.appendChild(thinkingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                return thinkingDiv;
            }

            addMessage(message, sender) {
                const chatMessages = document.getElementById('chat-messages');
                const messageDiv = document.createElement('div');
                
                if (sender === 'user') {
                    messageDiv.className = 'chat-bubble bg-blue-50 p-3 rounded-lg ml-8';
                    messageDiv.innerHTML = `<p class="text-sm text-right">${this.escapeHtml(message)}</p>`;
                } else {
                    messageDiv.className = 'chat-bubble bg-pink-50 p-3 rounded-lg mr-8';
                    messageDiv.innerHTML = `<p class="text-sm">${this.escapeHtml(message)}</p>`;
                }
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            new CatLogFilter();
        });
    </script>
</body>
</html>
